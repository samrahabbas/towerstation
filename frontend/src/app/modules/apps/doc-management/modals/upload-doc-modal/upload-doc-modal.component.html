<div>
  <input #fileUpload type="file" hidden
         (change)="onFileSelect($event.target)">
  <div class="card" [formGroup]="docForm">
    <div
      class="card-header border-0"
      aria-expanded="true">
      <div class="card-title m-0">
        <h3 class="fw-bolder m-0">Upload a new document</h3>
      </div>
      <div class="card-title m-0" role="button" (click)="closeModal()">
        <i class="fas fa-window-close fa-1x"></i>
      </div>
    </div>
    <div class="collapse show">
      <div class="card-body border-top p-9">
        <div class="row mb-6">
          <div class="col-lg-12">
            <div class="row">
              <div class="col-lg-8 fv-row">
                <div class="d-flex">
                  <div>
                    <button class="btn btn-success" (click)="fileUpload.click()">
                      <i class="fas fa-plus"></i>
                      <span>Select a document</span>
                    </button>
                  </div>
                  <div class="mt-4 ms-4">
                    <div *ngIf="file">
                      <span class="fv-file-name text-primary">{{file.name}}&nbsp;({{file.size | filesize}})</span>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-lg-4 fv-row text-end">
                <button class="btn btn-success" [disabled]="!file" (click)="onUploadDocument()">
                  <i class="fas fa-file-upload"></i>
                  <!-- <span>Upload</span> -->
                        <ng-container *ngIf="!isLoading">Upload</ng-container>
                         <ng-container *ngIf="isLoading">
                           <span clas="indicator-progress" [style.display]="'block'">
                             Please wait...{{ " " }}
                             <span
                               class="spinner-border spinner-border-sm align-middle ms-2"
                             ></span>
                           </span>
                        </ng-container>
                </button>
              </div>
            </div>
          </div>
        </div>
        <div *ngIf="file">
          <div class="row mb-6">
            <div class="mb-10 mt-5 bg-light-info p-8 rounded">
              <div class="text-info">
                <strong>
                  <i class="fas fa-info-circle text-info fs-5"></i>&nbsp;Heads up!
                </strong>
                <br>
                <p style="text-align: justify">
                  You can process the uploaded document immediately by filling out the form below. Optionally, you can
                  upload one or more documents now, and process them all later on the Document Processing screen.
                </p>
              </div>
            </div>
          </div>
          <div class="row mb-6">
            <div class="col-lg-12">
              <label class="col-form-label fw-bold fs-6">
                Attach This Document to Which Load(s) / Entities
              </label>
              <ng-select
                [items]="this.entities" formControlName="entities"
                class="custom-tag-select" [clearable]="true"
                placeholder="Select entities">
              </ng-select>
              <span class="text-muted">
                Select the load #, customer, carrier, and/or location to attach this document to. Leave blank if this your company's internal document.
              </span>
            </div>
          </div>
          <div class="row mb-6">
            <div class="col-lg-12">
              <label class="col-form-label required fw-bold fs-6">
                Document Name
              </label>
              <input
                type="text"
                formControlName="documentName"
                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0"
                placeholder="Document Name">
              <span class="text-muted">
                Change this only if you want an easy to read document name
              </span>
            </div>
          </div>
          <div class="row mb-6">
            <div class="col-lg-12">
              <label class="col-form-label fw-bold fs-6">
                Document Type(s)
              </label>
              <ng-select
                [items]="this.docTypes" formControlName="documentTypes"
                class="custom-tag-select" groupBy="group" 
                [clearable]="true" bindLabel="name"
                placeholder="Select document types">
              </ng-select>
              <span class="text-muted">
                Enter the general type of document this is related to.
                Select the type or types that best describe this document.
                Add any custom doc types you would like by typing the name and pressing Enter.
              </span>
            </div>
          </div>
          <div class="row mb-6">
            <div class="col-lg-12">
              <label class="col-form-label required fw-bold fs-6">
                Full Description Of This Document And Uses
              </label>
              <textarea
                type="text" rows="3"
                formControlName="documentDescription"
                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0"
                placeholder="Full Description Of This Document And Uses"></textarea>
              <span class="text-muted">
                Use this for internal notes about this document or to better describe what the document is used for. This is usually used for company internal documents.
              </span>
            </div>
          </div>
          <div class="row mb-6">
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-1 fv-row fv-plugins-icon-center">
                  <div class="d-flex align-items-center mt-3">
                    <label class="form-check form-check-inline form-check-solid me-5">
                      <input type="checkbox" formControlName="isCompanyDocument"
                             class="form-check-input">
                    </label>
                  </div>
                </div>
                <div class="col-lg-4 col-form-label fw-bold fs-6">
                  Mark as a company document
                </div>
              </div>
              <span class="text-muted">
                Company Documents are your standard documents that you want everyone to access and send out to your Customers, Carriers and Drivers etc.
              </span>
            </div>
          </div>
        </div>
      </div>
      <div class="card-footer py-6 px-9">
        <div class="row">
          <div class="col-lg-12 text-end">
            <button
              type="button"
              class="btn btn-danger" (click)="closeModal()"> Cancel
              <!--          <ng-container *ngIf="!isLoading">Save Changes</ng-container>-->
              <!--          <ng-container *ngIf="isLoading">-->
              <!--            <span clas="indicator-progress" [style.display]="'block'">-->
              <!--              Please wait...{{ " " }}-->
              <!--              <span-->
              <!--                class="spinner-border spinner-border-sm align-middle ms-2"-->
              <!--              ></span>-->
              <!--            </span>-->
              <!--          </ng-container>-->
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>